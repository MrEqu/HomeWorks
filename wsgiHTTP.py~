import selector
from jinja2 import Environment,FileSystemLoader


environ = {
    'HTTP_HOST': 'localhost:80',
    'PATH_INFO': '/article',
    'QUERY_STRING': 'id=1',
    'REQUEST_METHOD': 'GET',
    'SCRIPT_NAME': ''
}

status = '200 OK'
http_headers = [('Content-Type', 'text/html; charset=UTF-8')]
ABOUTME_LINK = """<a href="about/aboutme.html">LINK TO aboutme.html</a>"""
INDEX_LINK = """<a href="../index.html">LINK TO INDEX.HTML</a>"""


class BaseApp(object):

    def __init__(self,environ,start_response,link,template):
        self.env = environ
        self.start_response = start_response
        self.teplates  = Environment(loader=FileSystemLoader('templates'))
        super.__init__(env,start_response)
        self.template = template
        self.link = link

    def __iter__(self):
        self.start_responce(status,http_headers)
        template = self.teplates.get_template(self.template)
        yield template.render(link=self.link)
             
class IndexApp(BaseApp):
    def __init__(self,environ,start_responce):
        super.__init__(environ,start_responce,ABOUTME_LINK,"index.html")

class AboutApp(BaseApp):
    def __init__(self,environ,start_responce):
        super.__init__(environ,start_responce,INDEX_LINK,"about.html")
def init():
    disp =  selector.Selector()
    disp.add("/{any}",GET=IndexApp)
    disp.add("/about/about.html",GET=AboutApp)
    return app



if __name__=="__main__":
    from paste.httpserver import serve
    app = init()
    serve(app,host='localhost',port=8000)
